<!DOCTYPE html>        
<html lang="id">        
<head>        
  <meta charset="UTF-8" />        
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">        
<!-- Web App Manifest -->        
<link rel="manifest" href="manifest.json" />        
        
<!-- App Icons -->        
<link rel="icon" type="image/png" sizes="192x192" href="assets/icon-192.png" />        
<link rel="icon" type="image/png" sizes="512x512" href="assets/icon-512.png" />        
        
<!-- Android Theme -->        
<meta name="theme-color" content="#000000" />        
<meta name="mobile-web-app-capable" content="yes" />        
        
<!-- iOS support -->        
<meta name="apple-mobile-web-app-capable" content="yes" />        
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />        
<meta name="apple-mobile-web-app-title" content="JamYZ" />        
<meta name="color-scheme" content="dark light">
<link rel="apple-touch-icon" href="assets/icon-192.png" />        
<link rel="apple-touch-startup-image" href="assets/splash-screen.png">    
  <title>YudaTime¬Æ Neon Glass</title>        
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative&family=Great+Vibes&family=Cormorant+Garamond&display=swap" rel="stylesheet">     
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative&family=Great+Vibes&family=Cormorant+Garamond&display=swap"> 
<meta name="description" content="Jam Digital Neon Glass - Tampilan stylish, offline support, dan installable.">
	<link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css" />  
    <noscript>
  <strong>JavaScript dibutuhkan agar situs ini bisa berjalan offline.</strong>
</noscript>
  <style>        
    * {  
      margin: 0;  
      padding: 0;  
      box-sizing: border-box;  
    }  
    
    * {
    will-change: auto;
    transform: translateZ(0); /* Reduce GPU overuse */
  }

  video, canvas, img {
    filter: brightness(95%);
  }
    
:root {
  --color-primary: rgba(0, 255, 238, 0.08);       /* soft glass base */
  --color-accent: #ff4de8;
  --color-background: linear-gradient(120deg, #0e0e0e, #1a1a1a);
  --shadow-depth: 0 10px 32px rgba(0, 255, 255, 0.15);
  --glow-effect: 0 0 12px rgba(0, 255, 238, 0.6);

  --glass-blur: blur(18px);
  --border-glass: rgba(255, 255, 255, 0.1);
  --color-glow: rgba(0, 255, 238, 0.25);
}

body {
  background-image: var(--color-background), url('assets/bg.jpg');
  background-size: cover, cover;
  background-position: center, center;
  background-repeat: no-repeat, no-repeat;
  background-attachment: fixed, fixed;
  color: white;
  font-family: 'Poppins', sans-serif;
  filter: contrast(105%) saturate(115%) brightness(1.03);
  margin: 0;
  padding: 0;
}

/* Retina Glass Card */
.glass-retina {
  background: var(--color-primary);
  backdrop-filter: var(--glass-blur);
  -webkit-backdrop-filter: var(--glass-blur);
  border: 1px solid var(--border-glass);
  border-radius: 20px;
  box-shadow:
    inset 0 0 0.5px rgba(255, 255, 255, 0.1),
    0 4px 16px var(--color-glow),
    0 8px 24px rgba(0, 0, 0, 0.2);
  padding: 24px;
  transition: all 0.4s ease;
}

/* Hover effect (optional) */
.glass-retina:hover {
  transform: scale(1.02);
  box-shadow:
    inset 0 0 1px rgba(255, 255, 255, 0.15),
    0 6px 28px rgba(0, 255, 238, 0.35),
    0 12px 36px rgba(0, 0, 0, 0.3);
}

/* 3D Card Base */
.card-3d {
  box-shadow: var(--shadow-depth);
  transform: perspective(900px) rotateX(2deg);
  backdrop-filter: blur(12px) brightness(1.08);
  border-radius: 16px;
  padding: 20px;
  transition: all 0.4s ease;
}

  .visual-mode-all {
    filter:
      hue-rotate(5deg)
      saturate(1.6)
      contrast(1.2)
      brightness(1.1)
      contrast(1.1)
      brightness(0.95)
      saturate(1.2)
      brightness(1.3)
      contrast(1.25)
      saturate(1.4);
    transform: perspective(1000px) rotateX(2deg);
    border-radius: 12px;
    transition: all 0.5s ease;
  }

    html, body {  
  width: 100%;
  height: 100%;
  display: flex;
      overflow: hidden;  
      font-family: 'Segoe UI', sans-serif;  
        height: calc(var(--vh, 1vh) * 100);
            image-rendering: optimizeSpeed;
    scroll-behavior: smooth;
    -webkit-tap-highlight-color: transparent;
    }  
    
    body, html {
  height: 100%;
}

.bg-media {
  position: fixed;      /* Nempel di layar */
  top: 0;
  left: 0;
  width: 100%;
  height: 100vh;        /* Full tinggi layar */
  z-index: -1;          /* Di belakang konten */
  overflow: hidden;
  pointer-events: none; /* Biar nggak ganggu klik */
    object-fit: cover;    /* Potong rapi, tetap proporsional */
  object-position: center;
}

  .fullscreen-wrapper {      
  	      height: 100%;  
      width: 100%;  
  display: flex;      
  justify-content: center;      
  align-items: center;     
  flex: 1;  
  border-radius: 0;      
}      

.wrapper {
	      position: relative;      
  background: transparent;      
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
  width: 100%;
  height: 100%;
}
      
    .bg-fullscreen {  
  position: fixed;  
  top: 0;  
  left: 0;  
  	      height: 100%;  
      width: 100%;  
  object-fit: cover;  
  z-index: -1;  
}  
      
body {  
    width: 100%;
  height: 100vh;  
  display: flex;  
  justify-content: center;  
  align-items: center;  
  overflow: hidden;  
  padding-top: env(safe-area-inset-top);  
  padding-bottom: env(safe-area-inset-bottom);  
  padding-left: env(safe-area-inset-left);  
  padding-right: env(safe-area-inset-right);  
      z-index: 0;  
  flex-direction: column; /* Biar vertikal */
  position: relative;
}  

    .clock {      
      position: relative;      
      width: 280px;      
      height: 280px;      
      border-radius: 50%;      
      backdrop-filter: #0ff;      
      box-shadow: 0 8px 30px rgba(255,255,255,0.08), inset 0 0 25px rgba(255,255,255,0.08);      
      border: 4px solid rgba(255,255,255,0.1);      
  background-color: transparent;      
  color: white; /* atau warna neon/glow */      
  font-size: 4em;      
  text-shadow: 0 0 10px cyan; /* biar glow kayak jam digital */      
}      
      
.container {      
  background-color: transparent;      
  pointer-events: none; /* kalau konten bukan interaktif */      
    transition: all 0.3s ease-in-out;  
}      
      
.outlined {      
  color: #111; /* atau fill: #111 jika SVG */      
  text-shadow:      
    -1px -1px 1px #fff,      
     1px -1px 1px #fff,      
    -1px  1px 1px #fff,      
     1px  1px 1px #fff;      
}      
      
    .center {      
      position: absolute;      
      width: 12px;      
      height: 12px;      
      background: #fff;      
      border: 2px solid #000;      
      border-radius: 50%;      
      top: 50%;      
      left: 50%;      
      transform: translate(-50%, -50%);      
      z-index: 10;      
    }      
      
    .hand {      
      position: absolute;      
      top: 50%;      
      left: 50%;      
      transform-origin: bottom center;      
      transform: rotate(0deg);      
      border-radius: 4px;      
    }      
      
    .hour {      
      width: 6px;      
      height: 60px;      
      z-index: 3;      
    }      
          
     .hour, .minute {      
      background: #0ff;      
      box-shadow: 0 0 8px #0ff;      
    }      
      
    .minute {      
      width: 4px;      
      height: 90px;      
      z-index: 2;      
    }      
      
/* Gaya dasar */
.date-info {
  position: absolute;
  bottom: 13px;
  left: 52%;
  transform: translateX(-50%);
  padding: 6px 12px;
  font-size: 13px;
  font-family: 'Cormorant Garamond', serif;
  letter-spacing: 0.5px;
  font-weight: 500;
  text-shadow: 0 0 4px #000;
  color: #fff; /* default putih */
  background: rgba(0, 0, 0, 0.0); /* biar ada kontras */
  border-radius: 6px;
  z-index: 20;
}

    .brand-name {      
      position: absolute;      
      top: 50px;      
      left: 53%;      
      transform: translateX(-50%);      
      font-size: 30px;      
      font-weight: 500;      
color: #f5f5f5;       
text-shadow:      
  0 0 3px #fff,      
  0 0 5px #aaa,      
  1px 1px 2px rgba(0,0,0,0.6);      
      font-family: 'Cinzel Decorative', cursive;      
    }      
      
    .circular-text {      
      position: absolute;      
      width: 400px;      
      height: 400px;      
      top: 50%;      
      left: 50%;      
      transform: translate(-50%, -50%);      
      pointer-events: none;      
        fill: #00ffff; /* Warna biru terang */
          font-weight: bold;
    fill: white; /* default terang */
  transition: all 0.3s ease-in-out;
  mix-blend-mode: difference; /* bikin adaptif sama bg */
filter: drop-shadow(0 0 0.2px rgba(173, 255, 255, 0.18))
        drop-shadow(0 0 1.6px rgba(200, 255, 255, 0.07))
    }      

    .circular-text svg {      
      transform-origin: center;      
    }      

svg text {      
  font-weight: 600;      
  fill: #111; /* warna utama huruf */      
      stroke: rgba(255, 255, 255, 0.3); /* putih transparan */      
  stroke-width: 0.1px;      
  paint-order: stroke;      
  text-shadow:      
    0 0 1px #000, /* menjaga tajam di bg gelap */      
  font-size: 14px;      
  font-family: 'Great Vibes', cursive;      
  letter-spacing: 3px;      
}      
      
    .pulse-ring {      
      position: absolute;      
      width: 100%;      
      height: 100%;      
      border-radius: 50%;      
       box-shadow: none;      
      animation: none;      
    }      
          
.numeral {      
  position: absolute;      
  width: 30px;      
  height: 30px;      
  text-align: center;      
  line-height: 30px;      
  font-weight: bold;      
  color: #0ff;      
  font-size: 14px;      
  font-family: 'Cinzel Decorative', cursive;      
  transform: translate(-50%, -50%);      
  text-shadow: 0 0 6px #0ff;      
  will-change: text-shadow;      
}      
      
.clock::after {      
  content: "";      
  position: absolute;      
  top: 28px;      
  left: 28px;      
  width: 48%;      
  height: 16%;      
  background: radial-gradient(ellipse at top left, rgba(255,255,255,0.04), transparent);      
  border-radius: 50%;      
  filter: blur(0.5px);      
  opacity: 0.25;      
  pointer-events: none;      
}      
      
@keyframes pulse {      
  0% {      
    text-shadow: 0 0 6px #0ff;      
    opacity: 0.8;      
  }      
  50% {      
    text-shadow: 0 0 14px #0ff;      
    opacity: 1;      
  }      
      
  100% {      
    text-shadow: 0 0 6px #0ff;      
    opacity: 0.8;      
  }      
}      

body.locked {  
  overflow: hidden;  
}  

  .quote-container {
    position: absolute;
    top: calc(100% + 15px); /* Di bawah jam */
    width: 100%;
    text-align: center;
    padding: 10px;
    z-index: 10;
        margin-top: 30px;
          animation: fadeInBox 1s ease-out;
  }

  .quote-line {
    font-family: 'Cormorant Garamond', serif;
    font-size: 20px;
    color: #f5f5f5;
    margin: 0;
    white-space: pre-line;
    min-height: 60px;
      transition: opacity 0.5s ease-in-out;
  }

  .quote-author {
    font-family: 'Great Vibes', cursive;
    font-size: 24px;
    color: #12c2e9;
  font-weight: 500;
    margin-top: 10px;
      transition: opacity 0.5s ease-in-out;
        text-shadow: 0 0 8px rgba(255,255,255,0.4); /* glow halus */
  }

@keyframes fadeInBox {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#typedQuote, #quoteAuthor {
  transition: opacity 1.2s ease; /* halus fade */
  opacity: 1;
}

  #typedQuote {
background: linear-gradient(90deg, #12c2e9, #c471ed, #f64f59);
  text-shadow: 0 0 8px rgba(255,255,255,0.4); /* glow halus */
      white-space: pre-line;
  transition: opacity 0.5s ease;
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  font-weight: 600;
    color: #f0f0f0; /* Ubah ini sesuai selera kamu */
    font-family: 'Poiret One', cursive; /* Atau font sebelumnya yang kamu suka */
    font-size: 1.2rem;
    text-align: center;
    line-height: 1.6;
  }
  
    @supports (backdrop-filter: blur(10px)) {
  .glass {
    backdrop-filter: blur(10px);
  }
}
  
    .glass {
  background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  box-shadow: 0 0 30px rgba(0, 200, 255, 0.3);
  border-radius: 15px;
}
  
  .dynamic-light {
  background: radial-gradient(circle at var(--x) var(--y), rgba(255,255,255,0.1), transparent 80%);
}

#realisticPlayer {
  width: 100vw;
  height: 100vh;
  object-fit: cover;
  filter: brightness(1.1) contrast(1.25) saturate(1.15)
          drop-shadow(0 0 30px rgba(0,255,255,0.1))
          drop-shadow(0 0 40px rgba(255,255,255,0.05))
          blur(0.3px);
  transition: all 1s ease-in-out;
  background: radial-gradient(circle at center, #111 10%, #000 100%);
}

    </style>      
</head>      

<body onclick="enterFullscreenOnce()" style="margin:0; overflow:hidden;">      
	<!-- Tombol Lock/Unlock -->
<button id="screenLockBtn" title="Kunci layar" style="  
  font-size: 28px;
  background: none;
  border: none;
  color: #fff;
  position: absolute;
  bottom: 12px;
  right: 12px;
  cursor: pointer;
  z-index: 100;
  transition: transform 0.2s ease;
    display: none;
">üîí</button>

<!-- Layar lock overlay -->
<div id="screenLockOverlay" style="  
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.1);
  z-index: 99;
  pointer-events: all;
"></div>

<!-- Background div di belakang canvas -->
<div id="clockBg" style="
  position:absolute;
  width:300px;
  height:300px;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  border-radius:50%;
  overflow:hidden;
  z-index:0;
  background-size:cover;
  background-position:center;
  background-repeat:no-repeat;
"></div>

<canvas id="clockCanvas" width="300" height="300" style="
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  border-radius:50%;
  z-index:1;
  background:none;
"></canvas>


<div class="retina-glass">
	<div id="visualMode" class="content-overlay visual-mode-all">
		
<div class="bg-cover"></div>  
<div class="content">  
	<div class="bg-vivid"></div>  
<div class="glass-mask"></div>  
	    <div class="fullscreen-wrapper">    
  <div class="wrapper">    

    <div class="circular-text" id="circularText">      
      <svg viewBox="0 0 400 400">      
        <path id="circlePath" fill="none" d="M200,200 m-160,0 a160,160 0 1,1 320,0 a160,160 0 1,1 -320,0"/>      
        <text>      
          <textPath xlink:href="#circlePath">      
            ‚ú¶ My attitude depends on who you are ‚ú¶ My attitude depends on who you are ‚ú¶ My attitude depends on who you are ‚ú¶ -2025-       
          </textPath>      
        </text>      
      </svg>      
    </div>      
      
    <div class="clock">      
      <div class="pulse-ring"></div>      
      <div class="center"></div>      
      <div class="hand hour" id="hourHand"></div>      
      <div class="hand minute" id="minuteHand"></div>      
      <div id="numerals"></div>      
      <div class="brand-name">Y&Z¬Æ</div>      
      <div class="date-info" id="dateInfo"></div>      
    </div>      
  </div>      
  
<!-- Input file disembunyikan -->      
<input id="bgUpload" type="file" accept="image/*,video/mp4"style="display: none;">

<!-- Quotes Box -->
<div id="quoteBox" class="quote-container">
<p id="typedQuote" class="quote-line typing"></p>
<p id="quoteAuthor" class="quote-author"></p>
</div>

<!-- Audio Alarm Ping (online, dikomentarin dulu) -->
<audio id="alarmSound" src="https://raw.githubusercontent.com/yuda2525/jamY-Z/main/quote-ping.mp3" preload="auto"></audio> 

<!-- Audio Happy Birthday Medley (online) -->
<audio id="birthdayAudio" src="https://raw.githubusercontent.com/yuda2525/jamY-Z/main/happy_birthday_medley.mp3" preload="auto"></audio>


<!-- Script Three.js -->
<canvas id="hiddenCanvas" style="display: none;"></canvas>
<script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
  <script>      
  	window.addEventListener("error", e => console.error("‚ùå Global Error:", e.message));      
const romanNumerals = [      
  "I", "II", "III", "IV", "V", "", // kosongin VI      
  "VII", "VIII", "IX", "X", "XI", "XII"      
];      
      
    const numeralContainer = document.getElementById("numerals");      
      
    romanNumerals.forEach((num, i) => {      
      const angle = (i * 30 - 60) * Math.PI / 180;      
      const radius = 115;      
      const x = 140 + radius * Math.cos(angle);      
      const y = 140 + radius * Math.sin(angle);      
      
      const div = document.createElement("div");      
      div.className = "numeral";      
      div.style.left = `${x}px`;      
      div.style.top = `${y}px`;      
      div.innerText = num;      
      numeralContainer.appendChild(div);      
    });      
      
function updateClock() {      
  const now = new Date();      
  const sec = now.getSeconds();      
  const min = now.getMinutes();      
  const hr = now.getHours() % 12;      
      
  const minAngle = min * 6 + sec * 0.1;      
  const hrAngle = hr * 30 + min * 0.5;      
      
  document.getElementById('minuteHand').style.transform = `translate(-50%, -100%) rotate(${minAngle}deg)`;      
  document.getElementById('hourHand').style.transform = `translate(-50%, -100%) rotate(${hrAngle}deg)`;      
      
  // Rotate circular quote per detik (sync)      
  const rotateDegree = sec * 6;      
  document.querySelector('.circular-text svg').style.transform = `rotate(${rotateDegree}deg)`;      
      
// Trigger pulse on numerals every second      
const numerals = document.querySelectorAll('.numeral');      
numerals.forEach(num => {      
  num.style.animation = 'none';      
  num.offsetHeight; // Trigger reflow      
  num.style.animation = 'pulse 1s ease-in-out';      
});      
      
  // Date      
  const days = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];  
  const months = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];  
  const day = days[now.getDay()];      
  const date = now.getDate();      
  const month = months[now.getMonth()];      
  const year = now.getFullYear();      
  document.getElementById('dateInfo').innerText = `${day}, ${date} ${month} ${year}`;      
}      
      
function loopClock() {
  updateClock();
  setTimeout(() => requestAnimationFrame(loopClock), 1000);
}
requestAnimationFrame(loopClock);

    updateClock();      
      
      
// ==================== FULLSCREEN LOGIC ====================
let fullscreenActivated = false;

function goFullscreen() {
  if (fullscreenActivated) return;
  fullscreenActivated = true;

  const el = document.documentElement;
  if (el.requestFullscreen) el.requestFullscreen();
  else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
  else if (el.msRequestFullscreen) el.msRequestFullscreen();
}

function forceFullscreen() {
  const el = document.documentElement;
  if (!document.fullscreenElement) {
    if (el.requestFullscreen) el.requestFullscreen();
    else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
    else if (el.msRequestFullscreen) el.msRequestFullscreen();
  }
}

// Klik pertama ‚Üí aktifin fullscreen
document.addEventListener("click", goFullscreen, { once: true });

// ==================== BACKGROUND LOGIC ====================
const bgUpload = document.getElementById("bgUpload");
const clockCanvas = document.getElementById("clockCanvas");
const clockBg = document.getElementById("clockBg");
let lastTap = 0;
let videoEl = null;

// IndexedDB setup buat video
const DB_NAME = "BgMediaDB";
const STORE_NAME = "videos";

// buka DB
function openDB() {
  return new Promise((resolve, reject) => {
    const req = indexedDB.open(DB_NAME, 1);
    req.onupgradeneeded = e => {
      const db = e.target.result;
      if (!db.objectStoreNames.contains(STORE_NAME)) {
        db.createObjectStore(STORE_NAME);
      }
    };
    req.onsuccess = e => resolve(e.target.result);
    req.onerror = e => reject(e);
  });
}

async function saveVideo(file) {
  const db = await openDB();
  return new Promise((resolve, reject) => {
    const tx = db.transaction(STORE_NAME, "readwrite");
    tx.objectStore(STORE_NAME).put(file, "bgOuterVideo");
    tx.oncomplete = () => resolve();
    tx.onerror = e => reject(e);
  });
}

async function loadVideo() {
  const db = await openDB();
  return new Promise((resolve, reject) => {
    const tx = db.transaction(STORE_NAME, "readonly");
    const req = tx.objectStore(STORE_NAME).get("bgOuterVideo");
    req.onsuccess = () => resolve(req.result);
    req.onerror = e => reject(e);
  });
}

// Load background dari localStorage / IndexedDB
window.addEventListener("load", async () => {
  const bgOuter = localStorage.getItem("bgOuter");
  const bgInner = localStorage.getItem("bgInner");
  const bgOuterType = localStorage.getItem("bgOuterType");

  if (bgOuterType === "image" && bgOuter) {
    setImageBackground(bgOuter);
  } else if (bgOuterType === "video") {
    const file = await loadVideo();
    if (file) {
      const url = URL.createObjectURL(file);
      setVideoBackground(url);
    }
  }

  if (bgInner) clockBg.style.backgroundImage = `url('${bgInner}')`;
});

// Double tap detection
document.addEventListener("touchend", (e) => {
  const now = Date.now();
  if (now - lastTap < 300) {
    const rect = clockCanvas.getBoundingClientRect();
    const centerX = rect.left + rect.width / 2;
    const centerY = rect.top + rect.height / 2;
    const radius = rect.width / 2;

    const touch = e.changedTouches[0];
    const distance = Math.hypot(touch.clientX - centerX, touch.clientY - centerY);

    if (distance <= radius) changeBackground("inner");
    else changeBackground("outer");
  }
  lastTap = now;
});

// Ganti background
function changeBackground(type) {
  bgUpload.onchange = async function(event) {
    const file = event.target.files[0];
    if (!file) return;

    if (file.type.startsWith("video/")) {
      await saveVideo(file); // simpan ke IndexedDB
      const url = URL.createObjectURL(file);
      setVideoBackground(url);
      localStorage.setItem("bgOuterType", "video"); 
    } else {
      // kalau gambar
      const reader = new FileReader();
      reader.onload = function(e) {
        const bgData = e.target.result;
        if (type === "outer") {
          setImageBackground(bgData);
          localStorage.setItem("bgOuter", bgData);
          localStorage.setItem("bgOuterType", "image");
        } else {
          clockBg.style.backgroundImage = `url('${bgData}')`;
          localStorage.setItem("bgInner", bgData);
        }
      };
      reader.readAsDataURL(file);
    }

    // Delay kecil biar fullscreen aman
    setTimeout(() => forceFullscreen(), 400);
  };

  bgUpload.click();
}

// Helper: set image bg
function setImageBackground(data) {
  if (videoEl) {
    videoEl.remove();
    videoEl = null;
  }
  document.body.style.backgroundImage = `url('${data}')`;
  document.body.style.backgroundSize = "cover";
  document.body.style.backgroundPosition = "center";
  document.body.style.backgroundRepeat = "no-repeat";
}

// Helper: set video bg
function setVideoBackground(url) {
  if (videoEl) videoEl.remove();

  videoEl = document.createElement("video");
  videoEl.src = url;
  videoEl.autoplay = true;
  videoEl.loop = true;
  videoEl.muted = true;
  videoEl.playsInline = true;
  videoEl.style = `
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    object-fit: cover;
    z-index: -1;
  `;

  document.body.style.backgroundImage = ""; // reset bg image
  document.body.appendChild(videoEl);
}

// Optional: klik gambar masuk fullscreen
const img = document.getElementById("thumb");
if (img) {
  img.addEventListener("click", () => {
    forceFullscreen();
  });
}

// ==================== PWA / INPUT ====================
function isInStandaloneMode() {
  return window.matchMedia("(display-mode: standalone)").matches || window.navigator.standalone;
}
if (isInStandaloneMode()) {
  document.getElementById("bgUpload").style.display = "none";
}

// ==================== FALLBACK BACKGROUND ====================
window.addEventListener("DOMContentLoaded", async () => {
  const bgOuterType = localStorage.getItem("bgOuterType");
  const bgOuter = localStorage.getItem("bgOuter");
  const bgInner = localStorage.getItem("bgInner");

  if (bgOuterType === "image" && bgOuter) {
    setImageBackground(bgOuter);
  } else if (bgOuterType === "video") {
    const file = await loadVideo();
    if (file) {
      const url = URL.createObjectURL(file);
      setVideoBackground(url);
    }
  } else {
    // fallback default
    document.body.style.backgroundImage = `url('assets/bg.jpg')`;
  }

  if (bgInner) clockBg.style.backgroundImage = `url('${bgInner}')`;
});

// ==================== SMOOTH ENGINE 60FPS ====================
(function injectSmoothEngine() {
  const fps = 60;
  let ticking = true;
  let lastTime = performance.now();

  function loop() {
    if (!ticking) return;
    const now = performance.now();
    const delta = now - lastTime;

    if (delta >= 1000 / fps) {
      lastTime = now;
      document.dispatchEvent(new CustomEvent("pwaTick", { detail: { delta, now } }));
    }

    requestAnimationFrame(loop);
  }

  document.addEventListener("visibilitychange", () => {
    ticking = !document.hidden;
    if (ticking) lastTime = performance.now();
    if (ticking) loop();
  });

  console.log("‚úÖ [Smooth Engine] Aktif");
  loop();
})();

// ‚úÖ Fallback aman untuk fungsi animasi
window.animateBackground ??= () => {};
window.animateVisualizer ??= () => {};
window.gerakinCoverArt ??= () => {};
window.updateCustomMeter ??= () => {};

// Tick listener tiap frame
document.addEventListener("pwaTick", (e) => {
  const { delta, now } = e.detail;
  animateBackground(delta);
  animateVisualizer(delta);
  gerakinCoverArt();
  updateCustomMeter(now);
});

// ==================== MEMORY ENGINE MAX ====================
window.loadedImages = [];

(function MemoryEngineMax() {
  console.log("‚úÖ [Memory Engine Max] Aktif");

  const imagesToLoad = []; // bisa list preload di sini

  imagesToLoad.forEach((src) => {
    const img = new Image();
    img.src = src;
    img.onload = () => {
      window.loadedImages.push(img);
      console.log(`‚úÖ Loaded: ${src}`);
    };
    img.onerror = () => console.warn(`‚ö†Ô∏è Failed to load: ${src}`);
  });

  // bisa dipanggil manual buat inject ke elemen
  window.setBackgroundFromMemory = (index, targetElement) => {
    if (!window.loadedImages[index]) return;
    targetElement.style.backgroundImage = `url('${window.loadedImages[index].src}')`;
  };
})();

  
  window.addEventListener("resize", () => {
  document.documentElement.style.height = `${window.innerHeight}px`;
});
document.documentElement.style.height = `${window.innerHeight}px`;
  
  window.addEventListener('DOMContentLoaded', () => {
  const el = document.getElementById("visualMode");

  if (!el) {
    console.warn("Elemen #visualMode tidak ditemukan!");
    return;
  }

  console.log("üîµ Mode visual aktif!");

  // Tes tambahkan class manual satu-satu
  el.classList.add("dolby-vision");
  el.classList.remove("bravia-cinematic");
  el.classList.toggle("huawei-vivid");

  // Gabungan semuanya?
  el.classList.add("visual-mode-all");
});

function fixHeight() {
  const vh = window.innerHeight * 0.01;
  document.documentElement.style.setProperty('--vh', `${vh}px`);
}
window.addEventListener('resize', fixHeight);
fixHeight();

const lockBtn = document.getElementById("screenLockBtn");
const lockOverlay = document.getElementById("screenLockOverlay");

let isLocked = false;

function applyLockState() {
  if (isLocked) {
    lockOverlay.style.display = "block";
    lockBtn.textContent = "üîì";
    lockBtn.title = "Buka kunci";
  } else {
    lockOverlay.style.display = "none";
    lockBtn.textContent = "üîí";
    lockBtn.title = "Kunci layar";
  }
}

lockBtn.addEventListener("click", () => {
  isLocked = !isLocked;
  applyLockState();
});

// Auto lock saat halaman dimuat
window.addEventListener("load", () => {
  isLocked = true;
  applyLockState();
});

<!-- Panggil ini di bawah </body> -->
const weeklyQuotes = [
  // Minggu (0)
  {
    "09:00": {
      text: "Hari ini aku bangun dengan satu tujuan: mencintaimu lebih baik dari kemarin.",
      author: "- Najwa Shihab -"
    },
    "12:00": {
      text: "Aku ingin menjadi alasan di balik senyummu, bahkan saat kamu sedang makan siang sendirian.",
      author: "- Raditya Dika -"
    },
    "22:00": {
      text: "Jangan lupa istirahat, sayang. Mimpimu malam ini semoga tentang kita.",
      author: "- Boy Candra -"
    }
  },
  // Senin (1)
  {
    "09:00": {
      text: "Your love is the first thought in my mind when I wake up.",
      author: "- Jane Austen -"
    },
    "12:00": {
      text: "You make my heart smile even on the busiest of days.",
      author: "- A.R. Asher -"
    },
    "22:00": {
      text: "You‚Äôre my favorite notification before I sleep.",
      author: "- Beau Taplin -"
    }
  },
  // Selasa (2)
  {
    "09:00": {
      text: "Setiap hari bersamamu adalah awal yang baru untuk mencintai lebih dalam.",
      author: "- Merry Riana -"
    },
    "12:00": {
      text: "Cinta bukan sekadar kata, tapi tindakan yang tak kenal lelah.",
      author: "- Soekarno -"
    },
    "22:00": {
      text: "Ketika malam datang dan kamu jauh dariku, hatiku tetap bersamamu.",
      author: "- Ludwig van Beethoven -"
    }
  },
  // Rabu (3)
  {
    "09:00": {
      text: "When you arise in the morning, think of what a precious privilege it is to be alive‚Äîto breathe, to think, to enjoy, to love.",
      author: "- Marcus Aurelius -"
    },
    "12:00": {
      text: "Being deeply loved by someone gives you strength, while loving someone deeply gives you courage.",
      author: "- Lao Tzu -"
    },
    "22:00": {
      text: "Let us always meet each other with smile, for the smile is the beginning of love.",
      author: "- Mother Teresa -"
    }
  },
  // Kamis (4)
  {
    "09:00": {
      text: "Kopi pagi ini terasa manis karena ada namamu yang ikut larut di pikiranku.",
      author: "- Wira Nagara -"
    },
    "12:00": {
      text: "Cinta adalah kekuatan terbesar yang pernah dikenal manusia.",
      author: "- Mahatma Gandhi -"
    },
    "22:00": {
      text: "Tak ada yang lebih indah dari diamnya malam yang dipenuhi doa dan cinta.",
      author: "- Imam Al-Ghazali -"
    }
  },
  // Jumat (5)
  {
    "09:00": {
      text: "Jumat penuh berkah, dan berkah terbesarku adalah memilikimu.",
      author: "- K.H. Mustofa Bisri -"
    },
    "12:00": {
      text: "Bersamamu, bahkan diam di bawah matahari siang pun terasa teduh.",
      author: "- Dian Sastro -"
    },
    "22:00": {
      text: "Barangsiapa mencintai karena Allah, maka malamnya akan penuh damai dalam pelukan doa.",
      author: "- Syekh Abdul Qodir Jaelani -"
    }
  },
  // Sabtu (6)
  {
    "09:00": {
      text: "One word frees us of all the weight and pain of life: That word is love.",
      author: "- Sophocles -"
    },
    "12:00": {
      text: "The more I give to thee, the more I have, for both are infinite.",
      author: "- William Shakespeare -"
    },
    "22:00": {
      text: "You don‚Äôt find love, it finds you. It‚Äôs got a little bit to do with destiny, fate, and what‚Äôs written in the stars.",
      author: "- Ana√Øs Nin -"
    }
  }
];

let quotePlayedToday = {}; // buat tracking per waktu

function typeText(el, txt, speed = 120, onComplete = null) {
  el.textContent = "";
  let i = 0;
  const intv = setInterval(() => {
    el.textContent += txt.charAt(i++);
    if (i >= txt.length) {
      clearInterval(intv);
      if (onComplete) onComplete();
    }
  }, speed);
}

function playQuoteSequence(quote, repeat = 2) {
  const textEl = document.getElementById("typedQuote");
  const authorEl = document.getElementById("quoteAuthor");
  let currentRepeat = 0;

  function runOnce() {
    typeText(textEl, quote.text, 100, () => {
      setTimeout(() => {
        typeText(authorEl, quote.author, 80, () => {
          setTimeout(() => {
            textEl.style.opacity = 0;
            authorEl.style.opacity = 0;

            setTimeout(() => {
              textEl.textContent = "";
              authorEl.textContent = "";
              textEl.style.opacity = 1;
              authorEl.style.opacity = 1;

              currentRepeat++;
              if (currentRepeat < repeat) {
                setTimeout(runOnce, 1000);
              }
            }, 800);
          }, 5000);
        });
      }, 300);
    });
  }

  runOnce();
}


function checkTimeForQuotes() {
  const now = new Date();
  const day = now.getDay();
  const h = String(now.getHours()).padStart(2,"0");
  const m = String(now.getMinutes()).padStart(2,"0");
  const timeKey = `${h}:${m}`;
  const todayQuotes = weeklyQuotes[day];
  if (!todayQuotes) return;
  const quote = todayQuotes[timeKey];
  if (quote && !quotePlayedToday[timeKey]) {
    quotePlayedToday[timeKey] = true;
    playQuoteSequence(quote);
  }
}

// Reset harian tiap 00:01
setInterval(() => {
  const now = new Date();
  if (now.getHours() === 0 && now.getMinutes() === 1) {
    quotePlayedToday = {};
    console.log("Reset harian");
  }
}, 60000);

document.addEventListener("DOMContentLoaded", () => {
  setInterval(checkTimeForQuotes, 60000);
  checkTimeForQuotes();
});

// ==================== Alarm Routine ====================
let audioReady = false;
let alarmTriggered = [false, false, false]; // status trigger untuk 3 waktu

document.addEventListener('click', () => {
  const alarm = document.getElementById('alarmSound');
  alarm.play().then(() => {
    alarm.pause();
    alarm.currentTime = 0;
    audioReady = true;
    console.log('‚úÖ Audio di-unlock lewat klik');
  }).catch(err => console.warn('‚ùå Gagal unlock audio:', err));
}, { once: true });

const alarmTimes = [
  { hour: 9, minute: 0 },
  { hour: 12, minute: 0 },
  { hour: 22, minute: 0 }
];

setInterval(() => {
  const now = new Date();
  const h = now.getHours();
  const m = now.getMinutes();
  alarmTimes.forEach((time, i) => {
    if (!alarmTriggered[i] && audioReady && h === time.hour && m === time.minute) {
      const alarm = document.getElementById('alarmSound');
      alarm.play().then(() => {
        console.log(`üîî Alarm ${i+1} bunyi: ${h}:${m}`);
      }).catch(err => console.warn(`‚ùå Gagal play alarm ${i+1}:`, err));
      alarmTriggered[i] = true;
    }
  });
}, 1000);

// Reset tiap jam
let lastCheckedHour = new Date().getHours();
setInterval(() => {
  const nowHour = new Date().getHours();
  if (nowHour !== lastCheckedHour) {
    alarmTriggered = [false,false,false];
    lastCheckedHour = nowHour;
    console.log('üîÑ Reset alarmTriggered untuk jam baru');
  }
}, 60000);

// ==================== Queue system ====================
let isPlaying = false; // menandai quote sedang berjalan

function playQuoteOnce(quote, repeat = 2) {
  if (isPlaying) return; // block tap selama quote sedang berjalan
  isPlaying = true;

  // Jalankan sequence quote
  playQuoteSequence(quote, repeat);

  // Hitung durasi total sequence
  const textLen = quote.text.length;
  const authorLen = quote.author.length;
  const duration = ((textLen * 100 + 300) + (authorLen * 80 + 5000 + 800 + 1000)) * repeat;

  // Setelah selesai, aktifkan tap lagi
  setTimeout(() => {
    isPlaying = false;
  }, duration);
}

// ==================== Single Tap Random Quote + Ping ====================
document.body.addEventListener('click', () => {
  if (!audioReady) return;
  if (isPlaying) return; // ignore tap jika quote sedang berjalan

  const dayIndex = new Date().getDay();
  const todayQuotes = weeklyQuotes[dayIndex];
  if (!todayQuotes) return;

  const timeKeys = Object.keys(todayQuotes);
  if (timeKeys.length === 0) return;

  const randomKey = timeKeys[Math.floor(Math.random() * timeKeys.length)];
  const randomQuote = todayQuotes[randomKey];

  playQuoteOnce(randomQuote);

  const alarm = document.getElementById('alarmSound');
  alarm.play().catch(err => console.warn('‚ùå Gagal play ping:', err));
});


const visualEngineSettings = {
  postProcess: {
    exposure: {
      minBrightness: 0.8,
      maxBrightness: 1.2,
      autoAdjust: true,
      speed: 0.15
    },
    contrast: 1.15,
    saturation: 1.1,
    bloom: {
      enabled: true,
      intensity: 0.3,
      threshold: 1.1
    },
    vignette: {
      enabled: true,
      intensity: 0.15,
      smoothness: 0.6
    },
    chromaticAberration: {
      enabled: true,
      intensity: 0.02
    },
    motionBlur: {
      enabled: true,
      shutterAngle: 90
    },
    colorGrading: {
      lift: [1.0, 1.0, 1.0],
      gamma: [1.05, 1.05, 1.05],
      gain: [1.1, 1.1, 1.1]
    },
    lensFlare: {
      enabled: true,
      intensity: 0.2
    },
    ambientOcclusion: {
      enabled: true,
      radius: 0.5,
      intensity: 0.6
    },
    depthOfField: {
      enabled: true,
      focalDistance: 3.0,
      aperture: 2.8,
      blurAmount: 0.5
    }
  },
  skybox: {
    type: "gradient",
    topColor: "#1c1c2a",
    bottomColor: "#5c6c80"
  },
  lighting: {
    direction: [0.5, -1, 0.3],
    intensity: 1.0,
    color: "#ffffff",
    shadows: true
  },
  autoControl: {
    autoplay: true,
    loop: true,
    muted: false,
    volume: 1.0,
    controlsVisible: false
  }
};

  const canvas = document.getElementById("hiddenCanvas");

  const scene = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
  camera.position.z = 5;

  const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
  renderer.setSize(256, 256); // kecilin ukuran, cukup buat proses belakang layar

  // Buat object 3D
  const geometry = new THREE.BoxGeometry(2, 2, 2);
  const material = new THREE.MeshStandardMaterial({ color: 0x00ffcc });
  const cube = new THREE.Mesh(geometry, material);
  scene.add(cube);

  // Lighting
  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(5, 5, 5);
  scene.add(light);

  // Render loop (background)
  let frame = 0;
  function animate() {
    requestAnimationFrame(animate);
    cube.rotation.x += 0.01;
    cube.rotation.y += 0.01;

    renderer.render(scene, camera);

    if (++frame % 60 === 0) {
      console.log("üé• Background 3D rendering still active", frame);
    }
  }

  animate();
  

// ================= Snow + Birthday Medley =================
let snowManualEnabled = false;  
let snowAutoEnabled = false;  
let snowCanvas, ctx, snowflakes;  
let birthdayTriggered = localStorage.getItem('birthdayTriggered') === 'true';  
let munchkinTriggered = false;  
const birthdayAudio = document.getElementById("birthdayAudio");

function initSnow() {  
  if (snowCanvas) return;  
  snowCanvas = document.createElement("canvas");  
  document.body.appendChild(snowCanvas);  
  snowCanvas.style.position = "fixed";  
  snowCanvas.style.top = "0";  
  snowCanvas.style.left = "0";  
  snowCanvas.style.width = "100%";  
  snowCanvas.style.height = "100%";  
  snowCanvas.style.pointerEvents = "none";  
  snowCanvas.style.zIndex = "0"; 
  snowCanvas.width = window.innerWidth;  
  snowCanvas.height = window.innerHeight;  
  ctx = snowCanvas.getContext("2d");  

  const snowCount = 121;  
  snowflakes = Array.from({ length: snowCount }, () => ({  
    x: Math.random() * snowCanvas.width,  
    y: Math.random() * snowCanvas.height,  
    size: Math.random() * 2 + 1.5,  
    speed: Math.random() * 0.8 + 0.2,  
    sparkle:  Math.random() * Math.PI * 2,
    sparkleSpeed: Math.random() * 0.02 + 0.005,  
    flashChance: Math.random() * 0.1 + 0.05,  
    glowHue: Math.random() * 360  
  }));  

  window.addEventListener("resize", () => {  
    snowCanvas.width = window.innerWidth;  
    snowCanvas.height = window.innerHeight;  
  });  
}  

function renderSnow() {  
  requestAnimationFrame(renderSnow);  
  if (!(snowManualEnabled || snowAutoEnabled)) {  
    if (ctx) ctx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);  
    return;  
  }  
  ctx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);  
  snowflakes.forEach(flake => {  
    flake.y += flake.speed;  
    if (flake.y > snowCanvas.height) flake.y = 0;  
    flake.sparkle += flake.sparkleSpeed;  
    if (flake.sparkle > 1) flake.sparkle = 0;  
    const flash = Math.random() < flake.flashChance ? 1 : 0;  
    const alpha = 0.05 + flake.sparkle * 0.6 + flash * 0.8;  
    const sizeBoost = flake.size * (0.5 + flash * 0.7);  
    const hue = flake.glowHue;  
    ctx.fillStyle = `hsla(${hue}, 100%, 80%, ${alpha})`;  
    ctx.shadowColor = `hsla(${hue}, 100%, 80%, ${alpha})`;  
    ctx.shadowBlur = 30 + 50 * flake.sparkle + flash * 70;  
    ctx.beginPath();  
    ctx.arc(flake.x, flake.y, sizeBoost, 0, Math.PI * 2);  
    ctx.fill();  
  });  
}  

function playBirthdayAudioTwice() {  
  if (!birthdayAudio) return;  
  let playCount = 0;  
  birthdayAudio.currentTime = 0;  
  birthdayAudio.play().catch(() => console.warn("‚ö† Audio autoplay blocked"));  
  birthdayAudio.onended = () => {  
    playCount++;  
    if (playCount < 2) {  
      birthdayAudio.currentTime = 0;  
      birthdayAudio.play().catch(() => console.warn("‚ö† Audio autoplay blocked"));  
    } else {  
      snowAutoEnabled = false;  
      if (ctx) ctx.clearRect(0, 0, snowCanvas.width, snowCanvas.height);  
      console.log("‚ùÑ Snow auto OFF (birthday audio selesai 2x)");  
    }  
  };  
}  

document.body.addEventListener('click', () => {  
  if (!birthdayTriggered) {  
    birthdayTriggered = true;  
    localStorage.setItem('birthdayTriggered', 'true');  
    snowAutoEnabled = true;  
    playBirthdayAudioTwice();  
  }  
  if (!munchkinTriggered) {  
    munchkinTriggered = true;  
    console.log("üêæ Munchkin quotes triggered!");  
  }  
}, { once: true });  

let startY = 0;  
document.body.addEventListener("touchstart", e => startY = e.touches[0].clientY);  
document.body.addEventListener("touchend", e => {  
  const endY = e.changedTouches[0].clientY;  
  if (startY - endY > 50) {  
    snowManualEnabled = !snowManualEnabled;  
    console.log("‚õÑ Snow toggle manual:", snowManualEnabled);  
    if (snowManualEnabled) playBirthdayAudioTwice();  
  }  
});  

initSnow();  
renderSnow();






if ('serviceWorker' in navigator) {
  window.addEventListener('load', async () => {
    try {
      const reg = await navigator.serviceWorker.register('./sw.js');
      console.log('‚úÖ Service Worker terdaftar di:', reg.scope);

      // Kirim ping ke SW aktif (opsional)
      if (reg.active) {
        console.log('[Main] Kirim ping ke SW aktif');
        reg.active.postMessage('ping');
      }

      // Menerima balasan dari SW
      navigator.serviceWorker.addEventListener('message', (event) => {
        if (event.data?.type === 'quote-ready') {
          console.log('[Main] Quote siap dijalankan!');
          if (typeof jalankanQuote === 'function') {
            jalankanQuote();
          }
        }
      });

    } catch (err) {
      console.error('‚ùå Gagal mendaftarkan Service Worker:', err);
    }
  });
} else {
  console.warn('‚ö†Ô∏è Browser tidak mendukung Service Worker');
}


    console.log("‚úÖ Script Loaded");      
  </script>      
</body>      
</html>      
      






